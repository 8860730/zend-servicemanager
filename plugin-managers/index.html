<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>Plugin managers - zend-servicemanager</title>

    <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href="//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Libre+Baskerville:400,400italic,700&subset=latin,latin-ext" rel="stylesheet" type="text/css">
    <link href="../css/base.css" rel="stylesheet">
    <link href="../css/zf.css" rel="stylesheet">
    <link href="../css/prism-zf.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <span class="navbar-brand">
              <a href="http://framework.zend.com"><img src="../img/zf-logo-mark.png" height="28" alt="Zend Framework" /></a>
              <a href="..">zend-servicemanager</a>
            </span>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../quick-start/">Quick Start</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../configuring-the-service-manager/">Configuring the service manager</a>
</li>

                        
                            
<li >
    <a href="../delegators/">Delegators</a>
</li>

                        
                            
<li >
    <a href="../lazy-services/">Lazy services</a>
</li>

                        
                            
<li class="active">
    <a href="./">Plugin managers</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../migration/">Migration Guide</a>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="prev" href="../lazy-services/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="../migration/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/zendframework/zend-servicemanager">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <!-- content:begin -->
    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#plugin-managers">Plugin managers</a></li>
        
            <li><a href="#creating-a-plugin-manager">Creating a plugin manager</a></li>
        
            <li><a href="#configuring-a-plugin-manager">Configuring a plugin manager</a></li>
        
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<ol class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation">
  <li><a href="..">Docs</a> &raquo;</li>
  
    
      
        <li>Reference &raquo;</li>
      
    
  
  <li class="active">Plugin managers</li>
</ol>

<nav class="hidden-lg">
  <ul class="pager">
    <li class="previous">
      <a rel="prev" href="../lazy-services/"><i class="fa fa-arrow-left"></i> Previous</a>
    </li>
    <li class="next">
      <a rel="next" href="../migration/">Next <i class="fa fa-arrow-right"></i></a>
    </li>
  </ul>
</nav>

<h1 id="plugin-managers">Plugin managers</h1>
<p>Plugin managers are <em>specialized</em> service managers, typically used to create
homogeneous objects of a specific type.</p>
<p>Because a plugin manager extends a service manager, it works the same and can
be configured similarly. It provides a separation of concerns (it will be used
in specific contexts), and provides additional instance validation.</p>
<p>Zend Framework components extensively use plugin managers to create services
that share common functionalities. For instance, all validator services are
specified inside a specialized <code>ValidatorPluginManager</code>.</p>
<h2 id="creating-a-plugin-manager">Creating a plugin manager</h2>
<p>To create a plugin manager, you first need to create a new class that extends
<code>Zend\ServiceManager\AbstractPluginManager</code>:</p>
<pre class="codehilite"><code class="language-php">class ValidatorPluginManager extends AbstractPluginManager
{
    protected $instanceOf = ValidatorInterface::class;
}</code></pre>


<p>The <code>$instanceOf</code> variable specifies a class/interface type that all instances
retrieved from the plugin manager must fulfill. If an instance created by the
plugin manager does not match, a <code>Zend\ServiceManager\Exception\InvalidServiceException</code>
exception will be thrown.</p>
<p>Most of the time, this shortcut is enough. However if you have more complex
validation rules, you can override the <code>validate()</code> method:</p>
<pre class="codehilite"><code class="language-php">class ValidatorPluginManager extends AbstractPluginManager
{
    public function validate($instance)
    {
        if ($instance instanceof Foo || $instance instanceof Bar) {
            return;
        }

        throw new InvalidServiceException('This is not a valid service!');
    }
}</code></pre>


<h2 id="configuring-a-plugin-manager">Configuring a plugin manager</h2>
<p>A plugin manager requires that you pass a parent service manager (typically,
the application's service manager) as well as service configuration. Service
configuration follows the exact same pattern as for a normal service manager;
refer to the <a href="../configuring-the-service-manager/">configuring the service manager</a> section for details.</p>
<p>Because a plugin manager is often a service itself, we recommend you to
register the plugin manager as part of the general service manager, as shown
below:</p>
<pre class="codehilite"><code class="language-php">$serviceManager = new ServiceManager([
    'factories' =&gt; [
        ValidatorPluginManager::class =&gt; function(ContainerInterface $container, $requestedName) {
            return new ValidatorPluginManager($container, [
                'factories' =&gt; [
                    StringLengthValidator::class =&gt; InvokableFactory::class,
                ],
            ]);
        },
    ],
]);

// Get the plugin manager:

$pluginManager = $serviceManager-&gt;get(ValidatorPluginManager::class);

// Use the plugin manager

$validator = $pluginManager-&gt;get(StringLengthValidator::class);</code></pre>


<blockquote>
<p>Unlike the version 2 implementation, when inside the context of the factory
of a service created by a plugin manager, the passed container <strong>will not
be</strong> the plugin manager, but the parent service manager instead. If you need
access to other plugins of the same type, you will need to fetch the plugin
manager from the container:</p>
<pre class="codehilite"><code class="language-php">function ($container, $name, array $options = []) {
    $validators = $container-&gt;get(ValidatorPluginManager::class);
    // ...
}</code></pre>


</blockquote>

<hr />

<nav>
  <ul class="pager">
    <li class="previous">
      <a rel="prev" href="../lazy-services/"><i class="fa fa-arrow-left"></i> Previous</a>
    </li>
    <li class="next">
      <a rel="next" href="../migration/">Next <i class="fa fa-arrow-right"></i></a>
    </li>
  </ul>
</nav></div>
        
    </div>
    <!-- content:end -->

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Copyright (c) 2016 <a href="http://www.zend.com/">Zend Technologies USA Inc.</a><br></small>
        </p>
        <p><small><a href="http://framework.zend.com">Learn more about Zend Framework</a></small></p>
    </footer>

    <script src="../js/jquery-1.10.2.min.js"></script>
    <script src="../js/bootstrap-3.0.3.min.js"></script>
    <script src="../js/prism-zf.js"></script>

    <script>var base_url = '..';</script>
    <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
    <script src="../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
